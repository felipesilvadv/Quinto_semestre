nombres = c("desempleo", "pib", "año", "mes", "tiempo", "tasa", "imacec", "bcu")
tablas = c()
for (i in 1:n){
jpeg(paste("./plots/histplot_",nombres[i], ".jpg", sep = ""))
histplot(variables[i])
dev.off()
tablas[i] = ajustar_modelo(variables[i])
vector[i] = descriptiva(variables[i])
}
Tabla = rbind(vector[1], vector[2], vector[3], vector[4], vector[5], vector[6], vector[7],  vector[8])
rownames(Tabla) = nombres
Tabla
for (i in 1:n){
jpeg(paste("./plots/histplot_",nombres[i], ".jpg", sep = ""))
histplot(variables[i])
dev.off()
tablas[i] = ajustar_modelo(variables[i])
vector[i] = descriptiva(variables[i])
}
histplot=function(x,outline = TRUE){
par(mfrow=c(2,1))
hist(x,freq = FALSE)
#lines(density(x),col="red",lwd=2)
boxplot(x,outline = outline,horizontal = TRUE,col = "grey")
}
n = length(variables)
vector = c()
nombres = c("desempleo", "pib", "año", "mes", "tiempo", "tasa", "imacec", "bcu")
tablas = c()
for (i in 1:n){
jpeg(paste("./plots/histplot_",nombres[i], ".jpg", sep = ""))
histplot(variables[i])
dev.off()
tablas[i] = ajustar_modelo(variables[i])
vector[i] = descriptiva(variables[i])
}
n = length(variables)
vector = c()
nombres = c("desempleo", "pib", "año", "mes", "tiempo", "tasa", "imacec", "bcu")
tablas = c()
for (i in 1:n){
jpeg(paste("./plots/histplot_",nombres[i], ".jpg", sep = ""))
histplot(variables[i])
dev.off()
#tablas[i] = ajustar_modelo(variables[i])
vector[i] = descriptiva(variables[i])
}
Tabla = rbind(vector[1], vector[2], vector[3], vector[4], vector[5], vector[6], vector[7],  vector[8])
rownames(Tabla) = nombres
Tabla
Tabla
n = length(variables)
vector = c()
nombres = c("desempleo", "pib", "año", "mes", "tiempo", "tasa", "imacec", "bcu")
tablas = c()
for (i in 1:n){
jpeg(paste("./plots/histplot_",nombres[i], ".jpg", sep = ""))
histplot(variables[i])
dev.off()
#tablas[i] = ajustar_modelo(variables[i])
vector[i] = descriptiva(variables[i])
}
Tabla = rbind(vector[1], vector[2], vector[3], vector[4], vector[5], vector[6], vector[7],  vector[8])
rownames(Tabla) = nombres
Tabla
Tabla = rbind(vector[1], vector[2], vector[3], vector[4], vector[5], vector[6], vector[7],  vector[8])
rownames(Tabla) = nombres
Tabla
vector
n
base[1]
vector = c()
nombres = c("desempleo", "pib", "año", "mes", "tiempo", "tasa", "imacec", "bcu")
n = length(nombres)
tablas = c()
for (i in 1:n){
jpeg(paste("./plots/histplot_",nombres[i], ".jpg", sep = ""))
histplot(base[i])
dev.off()
tablas[i] = ajustar_modelo(base[i])
vector[i] = descriptiva(base[i])
}
vector = c()
nombres = c("desempleo", "pib", "año", "mes", "tiempo", "tasa", "imacec", "bcu")
n = length(nombres)
tablas = c()
for (i in 1:n){
jpeg(paste("./plots/histplot_",nombres[i], ".jpg", sep = ""))
histplot(base[i][2,])
dev.off()
tablas[i] = ajustar_modelo(base[i][2,])
vector[i] = descriptiva(base[i][2,])
}
base[1][2,]
base[1]
base[1][2,:]
base::
vector = c()
base_respaldo = base
base_respaldo = base
vector = c()
nombres = c("desempleo", "pib", "año", "mes", "tiempo", "tasa", "imacec", "bcu")
n = length(nombres)
tablas = c()
names(base) <- NULL
base[1]
for (i in 1:n){
jpeg(paste("./plots/histplot_",nombres[i], ".jpg", sep = ""))
histplot(base[i])
dev.off()
tablas[i] = ajustar_modelo(base[i])
vector[i] = descriptiva(base[i])
}
base = base_respaldo
blank.names <- function(dat){
for(i in 1:ncol(dat)){
names(dat)[i] <- paste(rep(" ",i),collapse="")
}
return(dat)
}
blank.names(base)
for (i in 1:n){
jpeg(paste("./plots/histplot_",nombres[i], ".jpg", sep = ""))
histplot(base[i])
dev.off()
tablas[i] = ajustar_modelo(base[i])
vector[i] = descriptiva(base[i])
}
base[1] = año
base[1]
año
variables = c(c(desempleo),c(pib),c(año), c(mes), c(tiempo), c(tasa), c(imacec), c(bcu))
variables[1]
c[3]
variables[3]
variables
head.matrix(base)
variable = head(base_respaldo)
variable
variable[1]
head(base,1)
head(base,0)
head(base,0)[1]
head(base,0)[2]
base$head(base,0)[1]
head(base, -1)
head(base, 0)[1]
head(base, 0)
base[0,]
base[1,]
base = read.table("TAREA2.txt", dec=",", header=FALSE)
base[1,]
base = read.table("TAREA2.txt", dec=",", header=TRUE)
base2 = read.table("TAREA2.txt", dec = ",", header = FALSE)
variables = base2[1,]
base$variables[1]
variables[1]
variables[1][1]
variables[1]$V1
variables[3]$V3
base[1]$AÑO
base$AÑO
apply(base, histplot)
apply(base,2, histplot)
apply(base,2, descriptiva)
apply(base, 2, ajustar_modelo)
base = read.table("TAREA2.txt", dec=",", header=TRUE)
head(base)
desempleo = base$DESEMPLEO
pib = base$PIB
año = base$AÑO
mes = base$MES
tiempo = base$TIEMPO
tasa = base$TASA_HIP
imacec = base$IMACEC
bcu = base$BCU1
ba.normal = function(Y, breaks = NULL){
## Requiere cargar libreria MASS
aux1 = as.vector(fitdistr(Y, "normal")$estimate)
aux2 = hist(Y, plot = F)
if(is.null(breaks) == 0){
aux2 = hist(Y, plot = F, breaks = breaks)
}
O = aux2$count
k = length(O)
q = c(-Inf, aux2$breaks[2:k], Inf)
p = diff(pnorm(q, mean = aux1[1], sd = aux1[2]))
n = length(Y)
E = n * p
X.1 = sum((O-E)^2/E)
valor.p = 1 - pchisq(X.1, df = k - 1 - 2)
list("Estadistico" = X.1, "valor.p" = valor.p)
}
Skewness=function(x){
n=length(x)
sum((x-mean(x))^3/n)/sd(x)^(3)
}
Kurtosis=function(x){
n=length(x)
sum((x-mean(x))^4/n)/sd(x)^(4)-3
}
recta=function(x,modelo="normal"){
y=sort(x)
N=length(y)
p=(1:N)/(N+1)
if (modelo=="exp"){
x1=-log(1-p)
plot(y~x1,main = "Comparaci?n con Exponencial")
linea=lm(y~x1)$coef
abline(linea,col="red",lwd=2)
alpha=linea[1]
lambda=1/linea[2]
a=c(alpha,lambda)
a
}
else{
if(modelo=="normal"){
x1=qnorm(p)
plot(y~x1,main = "Comparaci?n con Normal")
linea=lm(y~x1)$coef
abline(linea,col="red",lwd=2)
mu=linea[1]
sigma=linea[2]
a=c(mu,sigma)
a
}
else{
if(modelo=="log-normal"){
x1=qnorm(p)
plot(log(y)~x1,main = "Comparaci?n con Log-Normal")
linea=lm(log(y)~x1)$coef
abline(linea,col="red",lwd=2)
lambda=linea[1]
zeta=linea[2]
a=c(lambda,zeta)
a
}
else{
if(modelo=="logistica"){
x1=log(1/(1-p))
plot(y~x1,main = "Comparaci?n con Log?stica")
linea=lm(y~x1)$coef
abline(linea,col="red",lwd=2)
}
else{
if(modelo=="log-logistica"){
x1=log(1/(1-p))
plot(log(y)~x1,main = "Comparaci?n con log-Log?stica")
linea=lm(log(y)~x1)$coef
abline(linea,col="red",lwd=2)
mu=linea[1]
sigma=linea[2]
a=c(mu,sigma)
a
}
else{
if(modelo=="weibull"){
x1=log(-log(1-p))
plot(y~x1,main = "Comparaci?n con Weibull")
linea=lm(y~x1)$coef
abline(linea,col="red",lwd=2)
nu=exp(linea[1])
beta=1/linea[2]
a=c(nu,beta)
a
}
}
}
}
}
}
}
histplot=function(x,outline = TRUE){
par(mfrow=c(2,1))
hist(x,freq = FALSE)
lines(density(x),col="red",lwd=2)
boxplot(x,outline = outline,horizontal = TRUE,col = "grey")
}
descriptiva=function(x){
a1=min(x)
a2=quantile(x,0.25)
a3=median(x)
a4=mean(x)
a5=quantile(x,0.75)
a6=max(x)
b=sd(x)
c=Skewness(x)
d=Kurtosis(x)
Tabla=cbind(a1,a2,a3,a4,a5,a6,b,c,d)
colnames(Tabla)=c("Min.","1st Qu.","Median","Mean","3rd Qu.","Max.","SD","Skewness","Kurtosis")
rownames(Tabla)=c("")
Tabla
}
ajustar_modelo=function(x){
par(mfrow=c(2,3))
param_exp=recta(x,"exp")
param_norm=recta(x,"normal")
param_lognorm=recta(x,"log-normal")
param_logist=recta(x,"logistica")
param_loglogist=recta(x,"log-logistica")
param_weibull=recta(x,"weibull")
a=cbind(param_exp,param_norm,param_lognorm,param_logist,param_loglogist,param_weibull)
colnames(a)=c("exp","normal","log-normal","logist","log-logist","weibull")
a
}
nombres = c("año", "mes", "tiempo", "tasa", "desempleo", "imacec", "bcu", "pib")
base = read.table("TAREA2.txt", dec=",", header=TRUE)
head(base)
desempleo = base$DESEMPLEO
pib = base$PIB
año = base$AÑO
mes = base$MES
tiempo = base$TIEMPO
tasa = base$TASA_HIP
imacec = base$IMACEC
bcu = base$BCU1
ba.normal = function(Y, breaks = NULL){
## Requiere cargar libreria MASS
aux1 = as.vector(fitdistr(Y, "normal")$estimate)
aux2 = hist(Y, plot = F)
if(is.null(breaks) == 0){
aux2 = hist(Y, plot = F, breaks = breaks)
}
O = aux2$count
k = length(O)
q = c(-Inf, aux2$breaks[2:k], Inf)
p = diff(pnorm(q, mean = aux1[1], sd = aux1[2]))
n = length(Y)
E = n * p
X.1 = sum((O-E)^2/E)
valor.p = 1 - pchisq(X.1, df = k - 1 - 2)
list("Estadistico" = X.1, "valor.p" = valor.p)
}
Skewness=function(x){
n=length(x)
sum((x-mean(x))^3/n)/sd(x)^(3)
}
Kurtosis=function(x){
n=length(x)
sum((x-mean(x))^4/n)/sd(x)^(4)-3
}
recta=function(x,modelo="normal"){
y=sort(x)
N=length(y)
p=(1:N)/(N+1)
if (modelo=="exp"){
x1=-log(1-p)
plot(y~x1,main = "Comparaci?n con Exponencial")
linea=lm(y~x1)$coef
abline(linea,col="red",lwd=2)
alpha=linea[1]
lambda=1/linea[2]
a=c(alpha,lambda)
a
}
else{
if(modelo=="normal"){
x1=qnorm(p)
plot(y~x1,main = "Comparaci?n con Normal")
linea=lm(y~x1)$coef
abline(linea,col="red",lwd=2)
mu=linea[1]
sigma=linea[2]
a=c(mu,sigma)
a
}
else{
if(modelo=="log-normal"){
x1=qnorm(p)
plot(log(y)~x1,main = "Comparaci?n con Log-Normal")
linea=lm(log(y)~x1)$coef
abline(linea,col="red",lwd=2)
lambda=linea[1]
zeta=linea[2]
a=c(lambda,zeta)
a
}
else{
if(modelo=="logistica"){
x1=log(1/(1-p))
plot(y~x1,main = "Comparaci?n con Log?stica")
linea=lm(y~x1)$coef
abline(linea,col="red",lwd=2)
}
else{
if(modelo=="log-logistica"){
x1=log(1/(1-p))
plot(log(y)~x1,main = "Comparaci?n con log-Log?stica")
linea=lm(log(y)~x1)$coef
abline(linea,col="red",lwd=2)
mu=linea[1]
sigma=linea[2]
a=c(mu,sigma)
a
}
else{
if(modelo=="weibull"){
x1=log(-log(1-p))
plot(y~x1,main = "Comparaci?n con Weibull")
linea=lm(y~x1)$coef
abline(linea,col="red",lwd=2)
nu=exp(linea[1])
beta=1/linea[2]
a=c(nu,beta)
a
}
}
}
}
}
}
}
histplot=function(x,outline = TRUE){
par(mfrow=c(2,1))
hist(x,freq = FALSE)
lines(density(x),col="red",lwd=2)
boxplot(x,outline = outline,horizontal = TRUE,col = "grey")
}
descriptiva=function(x){
a1=min(x)
a2=quantile(x,0.25)
a3=median(x)
a4=mean(x)
a5=quantile(x,0.75)
a6=max(x)
b=sd(x)
c=Skewness(x)
d=Kurtosis(x)
Tabla=cbind(a1,a2,a3,a4,a5,a6,b,c,d)
colnames(Tabla)=c("Min.","1st Qu.","Median","Mean","3rd Qu.","Max.","SD","Skewness","Kurtosis")
rownames(Tabla)=c("")
Tabla
}
ajustar_modelo=function(x){
par(mfrow=c(2,3))
param_exp=recta(x,"exp")
param_norm=recta(x,"normal")
param_lognorm=recta(x,"log-normal")
param_logist=recta(x,"logistica")
param_loglogist=recta(x,"log-logistica")
param_weibull=recta(x,"weibull")
a=cbind(param_exp,param_norm,param_lognorm,param_logist,param_loglogist,param_weibull)
colnames(a)=c("exp","normal","log-normal","logist","log-logist","weibull")
a
}
base_respaldo = base
vector = c()
nombres = c("año", "mes", "tiempo", "tasa", "desempleo", "imacec", "bcu", "pib")
n = length(nombres)
tablas = c()
año=base$AÑO
jpeg(paste("./plots/histplot_",nombres[1], ".jpg", sep = ""))
histplot(año)
dev.off()
Tabla_año=ajustar_modelo(año)
f1=descriptiva(año)
mes=base$MES
jpeg(paste("./plots/histplot_",nombres[2], ".jpg", sep = ""))
histplot(mes)
dev.off()
Tabla_mes=ajustar_modelo(mes)
f2=descriptiva(mes)
tiempo=base$TIEMPO
jpeg(paste("./plots/histplot_",nombres[3], ".jpg", sep = ""))
histplot(tiempo)
dev.off()
Tabla_tiempo=ajustar_modelo(tiempo)
f3=descriptiva(tiempo)
tasa=base$TASA_HIP
jpeg(paste("./plots/histplot_",nombres[4], ".jpg", sep = ""))
histplot(tasa)
dev.off()
Tabla_tasa=ajustar_modelo(tasa)
f4=descriptiva(tasa)
desempleo=base$DESEMPLEO
jpeg(paste("./plots/histplot_",nombres[5], ".jpg", sep = ""))
histplot(desempleo)
dev.off()
Tabla_desempleo=ajustar_modelo(desempleo)
f5=descriptiva(desempleo)
imacec=base$IMACEC
jpeg(paste("./plots/histplot_",nombres[6], ".jpg", sep = ""))
histplot(imacec)
dev.off()
Tabla_imacec=ajustar_modelo(imacec)
f6=descriptiva(imacec)
bcu=base$BCU10
jpeg(paste("./plots/histplot_",nombres[7], ".jpg", sep = ""))
histplot(bcu)
dev.off()
Tabla_bcu=ajustar_modelo(bcu)
f7=descriptiva(bcu)
pib=base$PIB
jpeg(paste("./plots/histplot_",nombres[8], ".jpg", sep = ""))
histplot(pib)
dev.off()
Tabla_pib=ajustar_modelo(pib)
f8=descriptiva(pib)
Tabla = rbind(f1, f2, f3, f4, f5, f6, f7, f8)
rownames(Tabla) = nombres
Tabla
Tabla
desempleo=base$DESEMPLEO
jpeg(paste("./plots/histplot_",nombres[5], ".jpg", sep = ""))
histplot(desempleo)
dev.off()
head(base)
pairs(base)
jpeg(paste("./plots/histplot_",nombres[5], ".jpg", sep = ""))
histplot(desempleo)
dev.off()
pairs(base)
